<!DOCTYPE html>
<html lang="is">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>üéØ Or√∞ og mynd ‚Äì M√°lst√∂√∞in</title>
  <script src="lesson-config.js"></script>
  <script src="lesson-navigation.js"></script>
  <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
  <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
  <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
  <script src="https://cdn.tailwindcss.com"></script>
  <style>
    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', system-ui, sans-serif;
      background: linear-gradient(to bottom, #f8f7f4 0%, #e8e6e1 100%);
      min-height: 100vh;
    }
    .drop-zone {
      border: 2px dashed #ccc;
      border-radius: 1rem;
      padding: 1rem;
      min-height: 120px;
      display: flex;
      align-items: center;
      justify-content: center;
      background: white;
      transition: all 0.2s;
    }
    .drop-zone.correct { background: #e8f5e9; border-color: #81c784; }
    .drop-zone.wrong { background: #ffebee; border-color: #e57373; }
    .draggable {
      border: 1px solid #ddd;
      border-radius: 0.5rem;
      background: white;
      padding: 0.5rem 1rem;
      text-align: center;
      cursor: grab;
      transition: transform 0.15s;
    }
    .draggable:active { transform: scale(0.95); cursor: grabbing; }
    img {
      width: 100px;
      height: 100px;
      object-fit: cover;
      pointer-events: none;
      border-radius: 0.5rem;
    }
  </style>
</head>
<body>
  <div id="root"></div>

  <script type="text/babel">
    const { useState, useEffect } = React;

    const items = [
      { id: "row-1-column-1", label: "kaffi" },
      { id: "row-1-column-2", label: "brau√∞" },
      { id: "row-1-column-3", label: "heima" },
      { id: "row-2-column-1", label: "leiksk√≥li" },
      { id: "row-2-column-2", label: "l√≠kamsr√¶kt" },
      { id: "row-2-column-3", label: "taka myndir" },
      { id: "row-3-column-1", label: "n√°tt√∫ra" },
      { id: "row-3-column-2", label: "fara √≠ b√≠√≥" },
      { id: "row-3-column-3", label: "lesa b√≥k" },
    ];

    const shuffle = (array) => array.sort(() => Math.random() - 0.5);

    const OrdMyndir = () => {
      const [matches, setMatches] = useState({});
      const [done, setDone] = useState(false);
      const [words] = useState(shuffle([...items]));
      const [lessonInfo, setLessonInfo] = useState(null);
      const [savedLanguage, setSavedLanguage] = useState('English');

      useEffect(() => {
        // Get lesson info
        const info = getLessonInfo('para_myndir');
        setLessonInfo(info);
        
        // Get saved language
        const saved = localStorage.getItem('userLanguage') || 'English';
        setSavedLanguage(saved);
      }, []);

      const handleDrop = (e, targetId) => {
        e.preventDefault();
        const draggedId = e.dataTransfer.getData("text/plain");
        const correct = draggedId === targetId;
        setMatches(prev => ({ ...prev, [targetId]: { draggedId, correct } }));
      };

      const handleDragStart = (e, id) => {
        e.dataTransfer.setData("text/plain", id);
      };

      const checkResults = () => setDone(true);
      const reset = () => { setMatches({}); setDone(false); };

      return (
        <div className="min-h-screen pb-12">
          <header className="bg-white shadow-sm border-b border-gray-200">
            <div className="max-w-4xl mx-auto px-6 py-8">
              <button onClick={() => window.history.back()} className="text-sm text-gray-500 hover:text-gray-700 mb-2 inline-block font-light">
                ‚Üê Til baka
              </button>
              <h1 className="text-3xl font-light text-gray-800 mb-2">Para√∞u or√∞ og mynd</h1>
              <p className="text-gray-500 text-sm font-light">Para√∞u or√∞in vi√∞ r√©ttu myndina ¬∑ A1</p>
            </div>
          </header>

          <main className="max-w-4xl mx-auto px-6 mt-8">
            {/* Language Info */}
            <div className="bg-white rounded-lg shadow-sm p-6 mb-6">
              <div className="flex items-center justify-between">
                <p className="text-sm text-gray-600 font-light">
                  üåç M√≥√∞urm√°l: <strong>{savedLanguage}</strong>
                </p>
                <a 
                  href="byrjun.html" 
                  className="text-sm text-blue-600 hover:underline font-light"
                >
                  Breyta
                </a>
              </div>
            </div>

            <div className="bg-white rounded-lg shadow-sm p-8">
              <div className="text-center mb-8">
                <div className="text-6xl mb-4">üéØ</div>
                <h2 className="text-2xl font-light text-gray-800 mb-4">Drag√∞u or√∞in a√∞ r√©ttri mynd</h2>
                <p className="text-gray-600 font-light max-w-xl mx-auto mb-6">
                  Drag√∞u or√∞in √∫r listanum a√∞ myndunum fyrir ne√∞an.
                </p>
              </div>

              {/* Or√∞in efst */}
              <div className="flex flex-wrap justify-center gap-4 mb-8">
                {words.map(item => (
                  !Object.values(matches).some(m => m.draggedId === item.id) && (
                    <div
                      key={item.id}
                      draggable
                      onDragStart={(e) => handleDragStart(e, item.id)}
                      className="draggable shadow-sm"
                    >
                      {item.label}
                    </div>
                  )
                ))}
              </div>

              {/* Myndir */}
              <div className="grid grid-cols-3 gap-8 mb-12">
                {items.map(item => (
                  <div
                    key={item.id}
                    id={`zone-${item.id}`}
                    onDragOver={(e) => e.preventDefault()}
                    onDrop={(e) => handleDrop(e, item.id)}
                    className={`drop-zone ${matches[item.id]?.correct ? 'correct' : matches[item.id] ? 'wrong' : ''}`}
                  >
                    <img src={`images/${item.id}.png`} alt={item.label} />
                    {matches[item.id]?.draggedId && (
                      <p className="mt-2 text-gray-700 text-lg">
                        {items.find(i => i.id === matches[item.id].draggedId)?.label}
                      </p>
                    )}
                  </div>
                ))}
              </div>

              {/* Or√∞in endurtekin fyrir ne√∞an */}
              <div className="flex flex-wrap justify-center gap-4 mb-8">
                {words.map(item => (
                  !Object.values(matches).some(m => m.draggedId === item.id) && (
                    <div
                      key={`${item.id}-bottom`}
                      draggable
                      onDragStart={(e) => handleDragStart(e, item.id)}
                      className="draggable shadow-sm"
                    >
                      {item.label}
                    </div>
                  )
                ))}
              </div>

              <div className="text-center">
                {!done ? (
                  <button
                    onClick={checkResults}
                    className="bg-gray-800 text-white px-8 py-3 rounded-md hover:bg-gray-700 transition-colors font-light text-lg"
                  >
                    Athuga sv√∂rin
                  </button>
                ) : (
                  <button
                    onClick={reset}
                    className="bg-gray-800 text-white px-8 py-3 rounded-md hover:bg-gray-700 transition-colors font-light text-lg"
                  >
                    Pr√≥fa aftur
                  </button>
                )}
              </div>

              {done && (
                <div className="text-center mt-8">
                  <p className="text-gray-700 font-light">
                    √û√∫ para√∞ir {Object.values(matches).filter(m => m.correct).length} af {items.length} r√©tt üéâ
                  </p>
                </div>
              )}
            </div>

            {/* Navigation Buttons */}
            {lessonInfo && (
              <div className="flex justify-between gap-4 mt-8 mb-6">
                {lessonInfo.prev ? (
                  <a 
                    href={lessonInfo.prev.url}
                    className="flex-1 px-6 py-3 bg-white border-2 border-gray-200 rounded-lg text-gray-700 hover:border-blue-500 hover:text-blue-600 transition-all text-center font-light"
                  >
                    ‚Üê {lessonInfo.prev.name}
                  </a>
                ) : (
                  <a 
                    href="byrjun.html"
                    className="flex-1 px-6 py-3 bg-white border-2 border-gray-200 rounded-lg text-gray-700 hover:border-blue-500 hover:text-blue-600 transition-all text-center font-light"
                  >
                    ‚Üê Til baka
                  </a>
                )}
                
                {lessonInfo.next ? (
                  <a 
                    href={lessonInfo.next.url}
                    className="flex-1 px-6 py-3 bg-gray-800 text-white rounded-lg hover:bg-gray-700 transition-all text-center font-light"
                  >
                    {lessonInfo.next.name} ‚Üí
                  </a>
                ) : (
                  <a 
                    href="byrjun.html"
                    className="flex-1 px-6 py-3 bg-gradient-to-r from-green-500 to-green-600 text-white rounded-lg hover:from-green-600 hover:to-green-700 transition-all text-center font-light"
                  >
                    üéâ Kl√°ra√∞!
                  </a>
                )}
              </div>
            )}

            {/* Progress Bar */}
            {lessonInfo && (
              <div className="bg-white rounded-lg shadow-sm p-6 mb-6 border border-gray-200">
                <div className="flex justify-between items-center mb-3">
                  <span className="text-sm text-gray-600 font-light">
                    Skref {lessonInfo.index + 1} af {lessonInfo.total}
                  </span>
                  <span className="text-lg text-blue-600 font-medium">
                    {Math.round(((lessonInfo.index + 1) / lessonInfo.total) * 100)}%
                  </span>
                </div>
                <div className="w-full h-2 bg-gray-200 rounded-full overflow-hidden mb-4">
                  <div 
                    className="h-full bg-gradient-to-r from-blue-500 to-blue-600 rounded-full transition-all duration-500"
                    style={{ width: `${((lessonInfo.index + 1) / lessonInfo.total) * 100}%` }}
                  ></div>
                </div>
                <div className="flex gap-2 mb-3">
                  {LESSON_CONFIG.lessons.map((lesson, i) => (
                    <div 
                      key={lesson.id}
                      className={`flex-1 h-3 rounded-full transition-all ${
                        i < lessonInfo.index ? 'bg-green-500' :
                        i === lessonInfo.index ? 'bg-blue-500' :
                        'bg-gray-200'
                      }`}
                    ></div>
                  ))}
                </div>
                <div className="flex flex-wrap gap-2 text-xs text-gray-500">
                  {LESSON_CONFIG.lessons.map((lesson, i) => (
                    <React.Fragment key={lesson.id}>
                      <span className={`${
                        i < lessonInfo.index ? 'text-green-600 font-medium' :
                        i === lessonInfo.index ? 'text-blue-600 font-semibold' :
                        'text-gray-400'
                      }`}>
                        {lesson.icon} {lesson.name}
                      </span>
                      {i < LESSON_CONFIG.lessons.length - 1 && <span className="text-gray-300">‚Üí</span>}
                    </React.Fragment>
                  ))}
                </div>
              </div>
            )}
          </main>
        </div>
      );
    };

    ReactDOM.createRoot(document.getElementById("root")).render(<OrdMyndir />);
  </script>
</body>
</html>
