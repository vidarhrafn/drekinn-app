<!DOCTYPE html>
<html lang="is">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Byrjun ‚Äì M√°lst√∂√∞in</title>
  <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
  <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
  <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
  <script src="https://cdn.tailwindcss.com"></script>
  <style>
    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', system-ui, sans-serif;
      background: linear-gradient(to bottom, #f8f7f4 0%, #e8e6e1 100%);
      min-height: 100vh;
    }
    .vocab-word {
      text-decoration: underline;
      text-decoration-style: dotted;
      text-decoration-color: #1565c0;
      cursor: pointer;
      transition: all 0.2s;
      font-weight: 500;
      padding: 0 2px;
    }
    .vocab-word:hover {
      background-color: #e3f2fd;
      text-decoration-style: solid;
    }
    .exercise-card {
      background: white;
      border-radius: 8px;
      padding: 2.5rem 2rem;
      text-align: left;
      transition: all 0.3s ease;
      cursor: pointer;
      border: 1px solid #e8e6e1;
      text-decoration: none;
      color: inherit;
      display: flex;
      flex-direction: column;
      box-shadow: 0 2px 8px rgba(0, 0, 0, 0.04);
    }
    .exercise-card:hover {
      transform: translateY(-4px);
      box-shadow: 0 8px 24px rgba(0, 0, 0, 0.12);
      border-color: #d0cec9;
    }
  </style>
</head>
<body>
  <div id="root"></div>

  <script type="text/babel">
    const { useState, useEffect } = React;

    async function callOpenAI(payload) {
      const r = await fetch('/.netlify/functions/openai', {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify(payload),
      });
      const data = await r.json();
      if (!r.ok || data.error) throw new Error(data.error || `HTTP ${r.status}`);
      return data.content;
    }

    const Byrjun = () => {
      const [language, setLanguage] = useState('');
      const [savedLanguage, setSavedLanguage] = useState('');
      const [popup, setPopup] = useState(null);
      const [loadingTranslation, setLoadingTranslation] = useState(false);
      const [translatedHint, setTranslatedHint] = useState('');

      useEffect(() => {
        const saved = localStorage.getItem('userLanguage');
        if (saved) {
          setSavedLanguage(saved);
          setLanguage(saved);
          translateHint(saved);
        }
      }, []);

      const translateHint = async (lang) => {
        try {
          const sys = `Translate this instruction to ${lang}: "Tip: Click on underlined words to see translation in your native language!" Return ONLY the translation, nothing else.`;
          
          const response = await callOpenAI({
            model: 'gpt-4o',
            temperature: 0.3,
            max_tokens: 100,
            messages: [
              { role: 'system', content: sys },
              { role: 'user', content: 'Translate please' }
            ]
          });

          setTranslatedHint(response.trim());
        } catch (e) {
          console.error('Hint translation error:', e);
        }
      };

      const saveLanguage = () => {
        if (language.trim()) {
          localStorage.setItem('userLanguage', language.trim());
          setSavedLanguage(language.trim());
          translateHint(language.trim());
        }
      };

      const translateWord = async (word) => {
        if (!savedLanguage) {
          setPopup({ word, translation: 'Veldu fyrst √æitt m√≥√∞urm√°l!' });
          return;
        }

        setLoadingTranslation(true);
        setPopup({ word, translation: '...' });

        try {
          const sys = `You are a helpful translation assistant. Translate the Icelandic word "${word}" to ${savedLanguage}. Return ONLY the translation, nothing else. If it's a verb, give the infinitive form.`;
          
          const response = await callOpenAI({
            model: 'gpt-4o',
            temperature: 0.3,
            max_tokens: 50,
            messages: [
              { role: 'system', content: sys },
              { role: 'user', content: word }
            ]
          });

          setPopup({ word, translation: response.trim() });
        } catch (e) {
          console.error('Translation error:', e);
          setPopup({ word, translation: 'Villa vi√∞ √æ√Ω√∞ingu' });
        } finally {
          setLoadingTranslation(false);
        }
      };

      const VocabWord = ({ children }) => (
        <span 
          className="vocab-word"
          onClick={() => translateWord(children)}
        >
          {children}
        </span>
      );

      return (
        <div className="min-h-screen pb-12">
          <header className="bg-white shadow-sm border-b border-gray-200">
            <div className="max-w-6xl mx-auto px-6 py-8">
              <button 
                onClick={() => window.history.back()} 
                className="text-sm text-gray-500 hover:text-gray-700 mb-2 inline-block font-light"
              >
                ‚Üê Til baka
              </button>
              <h1 className="text-3xl font-light text-gray-800 mb-2">Byrjun</h1>
              <p className="text-gray-500 text-sm font-light">√Üfingar fyrir byrjendur ¬∑ A1</p>
            </div>
          </header>

          <main className="max-w-6xl mx-auto px-6 mt-8">
            {/* INNL√ñGN SECTION */}
            <section className="mb-12">
              {/* Language Selection */}
              <div className="bg-white rounded-lg shadow-sm p-6 mb-6">
                <div className="flex items-center gap-4 mb-4">
                  <div className="flex-1">
                    <label className="block text-sm font-light text-gray-600 mb-2">
                      üåç Hva√∞ er √æitt m√≥√∞urm√°l?
                    </label>
                    <input
                      type="text"
                      value={language}
                      onChange={(e) => setLanguage(e.target.value)}
                      onKeyDown={(e) => e.key === 'Enter' && saveLanguage()}
                      placeholder="t.d. English, Espa√±ol, Polski..."
                      className="w-full px-4 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-gray-400 font-light"
                    />
                  </div>
                  <button
                    onClick={saveLanguage}
                    className="mt-6 bg-gray-800 text-white px-6 py-2 rounded-md hover:bg-gray-700 transition-colors font-light"
                  >
                    Vista
                  </button>
                </div>
                
                {savedLanguage && (
                  <p className="text-sm text-green-600 mb-3 font-light">
                    ‚úì M√≥√∞urm√°l vista√∞: {savedLanguage}
                  </p>
                )}

                <div className="p-4 bg-blue-50 rounded-lg border border-blue-200">
                  <p className="text-sm text-blue-800 font-light">
                    üí° {savedLanguage && translatedHint ? (
                      <><strong>√Åbending:</strong> {translatedHint}</>
                    ) : (
                      <><strong>√Åbending:</strong> Smelltu √° undirstriku√∞ or√∞ til a√∞ sj√° √æ√Ω√∞ingu √° √æ√≠nu m√≥√∞urm√°li!</>
                    )}
                  </p>
                </div>
              </div>

              {/* Introduction Text */}
              <div className="bg-white rounded-lg shadow-sm p-8">
                <div className="prose prose-lg max-w-none space-y-4">
                  <p className="text-gray-700 leading-relaxed font-light text-lg">
                    H√¶! √âg <VocabWord>heiti</VocabWord> <VocabWord>Mia</VocabWord>. √âg <VocabWord>er</VocabWord> fr√° <VocabWord>√ökra√≠nu</VocabWord>. √âg <VocabWord>kom</VocabWord> til <VocabWord>√çslands</VocabWord> √°ri√∞ 2023. √âg <VocabWord>b√Ω</VocabWord> √≠ <VocabWord>Reykjav√≠k</VocabWord> <VocabWord>n√∫na</VocabWord>.
                  </p>

                  <p className="text-gray-700 leading-relaxed font-light text-lg">
                    √âg <VocabWord>er</VocabWord> 28 <VocabWord>√°ra</VocabWord>. √âg <VocabWord>er</VocabWord> <VocabWord>leiksk√≥lakennari</VocabWord>. √âg <VocabWord>vinn</VocabWord> √° <VocabWord>leiksk√≥la</VocabWord> me√∞ <VocabWord>litlum</VocabWord> <VocabWord>b√∂rnum</VocabWord>. √âg <VocabWord>elska</VocabWord> <VocabWord>starfi√∞</VocabWord> mitt.
                  </p>

                  <p className="text-gray-700 leading-relaxed font-light text-lg">
                    √âg <VocabWord>tala</VocabWord> <VocabWord>√∫kra√≠nsku</VocabWord> og <VocabWord>ensku</VocabWord>. √âg <VocabWord>er</VocabWord> a√∞ <VocabWord>l√¶ra</VocabWord> <VocabWord>√≠slensku</VocabWord> <VocabWord>n√∫na</VocabWord>. <VocabWord>√çslenska</VocabWord> <VocabWord>er</VocabWord> <VocabWord>erfi√∞</VocabWord> en <VocabWord>skemmtileg</VocabWord>. √âg <VocabWord>skil</VocabWord> <VocabWord>miki√∞</VocabWord> en <VocabWord>tala</VocabWord> ekki <VocabWord>miki√∞</VocabWord> <VocabWord>enn√æ√°</VocabWord>.
                  </p>

                  <p className="text-gray-700 leading-relaxed font-light text-lg">
                    √Å <VocabWord>morgnana</VocabWord> <VocabWord>drekk</VocabWord> √©g <VocabWord>kaffi</VocabWord> og <VocabWord>bor√∞a</VocabWord> <VocabWord>brau√∞</VocabWord>. √âg <VocabWord>fer</VocabWord> √° <VocabWord>leiksk√≥lann</VocabWord> klukkan <VocabWord>√°tta</VocabWord>. Eftir <VocabWord>vinnu</VocabWord> <VocabWord>fer</VocabWord> √©g √≠ <VocabWord>l√≠kamsr√¶kt</VocabWord> e√∞a √° <VocabWord>kaffih√∫s</VocabWord> me√∞ <VocabWord>vinum</VocabWord>.
                  </p>

                  <p className="text-gray-700 leading-relaxed font-light text-lg">
                    Um <VocabWord>helgar</VocabWord> <VocabWord>vil</VocabWord> √©g <VocabWord>fara</VocabWord> <VocabWord>√∫t</VocabWord> √≠ <VocabWord>n√°tt√∫runa</VocabWord>. √âg <VocabWord>elska</VocabWord> a√∞ <VocabWord>taka</VocabWord> <VocabWord>myndir</VocabWord>. <VocabWord>Stundum</VocabWord> <VocabWord>fer</VocabWord> √©g √≠ <VocabWord>b√≠√≥</VocabWord> e√∞a <VocabWord>les</VocabWord> <VocabWord>b√≥k</VocabWord> <VocabWord>heima</VocabWord>.
                  </p>
                </div>
              </div>
            </section>

            {/* EXERCISES SECTION */}
            <section>
              <h2 className="text-2xl font-light text-gray-800 mb-6">√Üfingar</h2>
              <div className="grid grid-cols-1 md:grid-cols-2 gap-6">
                <a href="eydufylling.html" className="exercise-card">
                  <div className="text-5xl mb-4">üìù</div>
                  <h3 className="text-xl font-normal text-gray-800 mb-3">Ey√∞ufylling</h3>
                  <p className="text-gray-600 leading-relaxed mb-4 font-light flex-grow">
                    Fylltu √≠ ey√∞urnar √≠ einf√∂ldum setningum. √Üf√∞u grunnm√°lfr√¶√∞i og or√∞afor√∞a me√∞ stu√∞ningi gervigreindar.
                  </p>
                  <div className="flex items-center gap-3 text-sm">
                    <span className="px-3 py-1 bg-blue-50 text-blue-700 rounded font-medium">A1</span>
                    <span className="text-gray-500 font-light">~5-10 m√≠n√∫tur</span>
                  </div>
                  <p className="text-xs text-gray-400 italic mt-3">Lykilor√∞: heita, vera, koma fr√°, b√∫a, tala</p>
                </a>

                <a href="finndu-villuna.html" className="exercise-card">
                  <div className="text-5xl mb-4">üîç</div>
                  <h3 className="text-xl font-normal text-gray-800 mb-3">Finndu villuna</h3>
                  <p className="text-gray-600 leading-relaxed mb-4 font-light flex-grow">
                    Lestu setningar me√∞ villum og lei√∞r√©ttu √æ√¶r. L√¶r√∞u af algengum mist√∂kum og f√°√∞u endurgj√∂f.
                  </p>
                  <div className="flex items-center gap-3 text-sm">
                    <span className="px-3 py-1 bg-blue-50 text-blue-700 rounded font-medium">A1</span>
                    <span className="text-gray-500 font-light">~10 m√≠n√∫tur</span>
                  </div>
                  <p className="text-xs text-gray-400 italic mt-3">Lykilor√∞: sagnbeygingar, fallbeygingar, grunnm√°lfr√¶√∞i</p>
                </a>

                <a href="kaffihusid.html" className="exercise-card">
                  <div className="text-5xl mb-4">‚òï</div>
                  <h3 className="text-xl font-normal text-gray-800 mb-3">Kaffih√∫si√∞</h3>
                  <p className="text-gray-600 leading-relaxed mb-4 font-light flex-grow">
                    Leiktu a√∞ √æ√∫ s√©rt √° kaffih√∫si og panta mat og drykk. Raunh√¶f samr√¶√∞u√¶fing √≠ vinalegu umhverfi!
                  </p>
                  <div className="flex items-center gap-3 text-sm">
                    <span className="px-3 py-1 bg-blue-50 text-blue-700 rounded font-medium">A1</span>
                    <span className="text-gray-500 font-light">~10-15 m√≠n√∫tur</span>
                  </div>
                  <p className="text-xs text-gray-400 italic mt-3">Lykilor√∞: panta, vilja, f√°, taka, bor√∞a, drekka</p>
                </a>

                <a href="spjallleikrit.html" className="exercise-card">
                  <div className="text-5xl mb-4">üí¨</div>
                  <h3 className="text-xl font-normal text-gray-800 mb-3">Spjallleikrit: Kynning</h3>
                  <p className="text-gray-600 leading-relaxed mb-4 font-light flex-grow">
                    Kynntu √æig fyrir gervigreind sem spyr einfaldar spurningar. √Üf√∞u a√∞ segja fr√° √æ√©r √° √≠slensku!
                  </p>
                  <div className="flex items-center gap-3 text-sm">
                    <span className="px-3 py-1 bg-blue-50 text-blue-700 rounded font-medium">A1</span>
                    <span className="text-gray-500 font-light">~10 m√≠n√∫tur</span>
                  </div>
                  <p className="text-xs text-gray-400 italic mt-3">Lykilor√∞: nafn, aldur, b√∫seta, uppruni, √°hugam√°l</p>
                </a>
              </div>
            </section>
          </main>

          {/* Translation Popup */}
          {popup && (
            <div 
              className="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4"
              onClick={() => setPopup(null)}
            >
              <div 
                className="bg-white rounded-lg shadow-xl p-6 max-w-md w-full"
                onClick={(e) => e.stopPropagation()}
              >
                <div className="flex justify-between items-start mb-4">
                  <h3 className="text-xl font-light text-gray-800">√û√Ω√∞ing</h3>
                  <button 
                    onClick={() => setPopup(null)}
                    className="text-gray-400 hover:text-gray-600 text-2xl leading-none"
                  >
                    √ó
                  </button>
                </div>
                <div className="space-y-3">
                  <div>
                    <p className="text-sm text-gray-500 font-light">√çslenska:</p>
                    <p className="text-2xl font-normal text-gray-800">{popup.word}</p>
                  </div>
                  <div>
                    <p className="text-sm text-gray-500 font-light">{savedLanguage || '√û√Ω√∞ing'}:</p>
                    <p className="text-2xl font-normal text-blue-600">
                      {loadingTranslation ? '...' : popup.translation}
                    </p>
                  </div>
                </div>
                <button
                  onClick={() => setPopup(null)}
                  className="mt-6 w-full bg-gray-800 text-white px-4 py-2 rounded-md hover:bg-gray-700 transition-colors font-light"
                >
                  Loka
                </button>
              </div>
            </div>
          )}

          <footer className="mt-16 py-8 text-center text-gray-400 text-sm font-light">
            <p>¬© 2025 M√°lst√∂√∞in</p>
          </footer>
        </div>
      );
    };

    ReactDOM.createRoot(document.getElementById('root')).render(<Byrjun />);
  </script>
</body>
</html>
